<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vrije Route - Mural Walk</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

</head>
<body>
    <button class="back-button" onclick="window.location.href='index.html'">
        <img src="img/icons/pijltje-2.png" alt="Terug">
    </button>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize map centered on Bernardinus College
        const map = L.map('map', {
            zoomControl: false
        }).setView([50.882036, 5.984278], 17);

        // Add zoom control to bottom right
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: ' OpenStreetMap contributors'
        }).addTo(map);

        // Load and display murals
        fetch('./data/heerlen-murals.json')
            .then(response => {
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                console.log('Loaded data:', data);
                // Add start location marker
                const startMarker = L.marker([data.startLocation.coordinates.lat, data.startLocation.coordinates.lng], {
                    icon: L.icon({
                        iconUrl: 'img/marker-icon-2x-red.png',
                        shadowUrl: 'img/marker-shadow.png',
                        iconSize: [25, 41],
                        iconAnchor: [12, 41],
                        popupAnchor: [1, -34],
                        shadowSize: [41, 41]
                    })
                }).addTo(map);

                startMarker.bindPopup(`<b>${data.startLocation.name}</b><br>${data.startLocation.address}`);

                // Add mural markers
                data.murals.forEach(mural => {
                    console.log('Processing mural:', mural);
                    const marker = L.marker([mural.location.coordinates.lat, mural.location.coordinates.lng], {
                        icon: L.icon({
                            iconUrl: 'img/marker-icon-2x-red.png',
                            shadowUrl: 'img/marker-shadow.png',
                            iconSize: [25, 41],
                            iconAnchor: [12, 41],
                            popupAnchor: [1, -34],
                            shadowSize: [41, 41]
                        })
                    }).addTo(map);

                    const popupContent = `
                        <div class="mural-popup">
                            <img src="${mural.thumbnail}" alt="${mural.title}">
                            <h3>${mural.title}</h3>
                            <p>${mural.artist}, ${mural.year}</p>
                            <p>${mural.description}</p>
                            <a href="detail.html?id=${mural.id}" class="custom-button">
                                <span>Meer info</span>
                                <img src="img/icons/pijltje-2.png" class="button-icon" alt="Pijl">
                            </a>
                        </div>
                    `;

                    marker.bindPopup(popupContent);
                });
            })
            .catch(error => {
                console.error('Error loading murals:', error);
                alert('Er is een fout opgetreden bij het laden van de murals. Probeer de pagina te verversen.');
            });
    </script>
</body>
</html>
